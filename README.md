# ðŸ­ GoldenMouse - æ·±åœ³æŠ€æœ¯å¤§å­¦å…¬æ–‡é€š

> è®©æ ¡å›­ä¿¡æ¯è§¦æ‰‹å¯åŠ

ä¸€ä¸ªé›†æˆäº†ç½‘é¡µçˆ¬è™«ã€é‚®ä»¶è®¢é˜…å’Œæ•°æ®å±•ç¤ºçš„æ·±åœ³æŠ€æœ¯å¤§å­¦å…¬æ–‡é€šçŸ¥ç³»ç»Ÿã€‚

## âœ¨ åŠŸèƒ½ç‰¹è‰²

- ðŸ•·ï¸ **æ™ºèƒ½çˆ¬è™«**: è‡ªåŠ¨çˆ¬å–æ·±åœ³æŠ€æœ¯å¤§å­¦å®˜æ–¹å…¬æ–‡é€šçŸ¥
- ðŸ“§ **ä¸ªæ€§åŒ–é‚®ä»¶è®¢é˜…**: æ”¯æŒæŒ‰å¹³å°å’Œé¢‘çŽ‡çš„ä¸ªæ€§åŒ–æŽ¨é€
- ðŸ“± **å“åº”å¼Webç•Œé¢**: ä»Šæ—¥é€šçŸ¥ã€åŽ†å²å½’æ¡£ã€è®¢é˜…ç®¡ç†
- â° **å®šæ—¶ä»»åŠ¡**: è‡ªåŠ¨å®šæ—¶çˆ¬å–å’ŒæŽ¨é€æ–°é€šçŸ¥
- ðŸ’¾ **æ•°æ®æŒä¹…åŒ–**: SQLiteæ•°æ®åº“å­˜å‚¨æ–‡ç« å’Œè®¢é˜…ä¿¡æ¯

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/yourusername/GoldenMouse.git
cd GoldenMouse
```

### 2. çŽ¯å¢ƒé…ç½®

æŽ¨èä½¿ç”¨ [uv](https://github.com/astral-sh/uv) ä½œä¸ºåŒ…ç®¡ç†å™¨ï¼š

```bash
# å®‰è£… uv (å¦‚æžœå°šæœªå®‰è£…)
pip install uv

# å®‰è£…é¡¹ç›®ä¾èµ–
uv sync
```

æˆ–è€…ä½¿ç”¨ä¼ ç»Ÿçš„pipæ–¹å¼ï¼š

```bash
pip install -r requirements.txt
```

### 3. é…ç½®é‚®ä»¶æœåŠ¡

ç¼–è¾‘ `config.py` æ–‡ä»¶ï¼Œé…ç½®æ‚¨çš„SMTPé‚®ä»¶æœåŠ¡ã€‚å°†ä»¥ä¸‹é…ç½®æ›¿æ¢ä¸ºæ‚¨çš„å®žé™…é‚®ä»¶æœåŠ¡ä¿¡æ¯ï¼š

```python
# ========== é‚®ä»¶é…ç½® ==========
SMTP_SERVER = "smtp.your-email-provider.com"  # æ‚¨çš„SMTPæœåŠ¡å™¨
SMTP_PASSWORD = "your_app_password"            # æ‚¨çš„é‚®ç®±åº”ç”¨å¯†ç 
MY_EMAIL = "your-email@example.com"            # å‘é€é‚®ä»¶çš„é‚®ç®±åœ°å€

# è®¢é˜…è€…é‚®ç®±æ ¼å¼é™åˆ¶ï¼ˆå¯æ ¹æ®éœ€è¦ä¿®æ”¹ï¼‰
SUBSCRIBER_MASK = r"^\d+@stumail\.sztu\.edu\.cn$"  # æ·±åœ³æŠ€æœ¯å¤§å­¦å­¦ç”Ÿé‚®ç®±æ ¼å¼
```

**å¸¸è§é‚®ä»¶æœåŠ¡å•†é…ç½®ç¤ºä¾‹ï¼š**

- **QQé‚®ç®±**: 
  - SMTPæœåŠ¡å™¨: `smtp.qq.com`
  - ç«¯å£: 587 (TLS) æˆ– 465 (SSL)
  - éœ€è¦å¼€å¯SMTPæœåŠ¡å¹¶èŽ·å–æŽˆæƒç 

- **163é‚®ç®±**:
  - SMTPæœåŠ¡å™¨: `smtp.163.com` 
  - ç«¯å£: 587 æˆ– 25
  - éœ€è¦å¼€å¯SMTPæœåŠ¡å¹¶èŽ·å–æŽˆæƒç 

- **Gmail**:
  - SMTPæœåŠ¡å™¨: `smtp.gmail.com`
  - ç«¯å£: 587
  - éœ€è¦å¼€å¯ä¸¤æ­¥éªŒè¯å¹¶ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç 

### 4. è¿è¡ŒæœåŠ¡

```bash
# ä½¿ç”¨ uv è¿è¡Œ (æŽ¨è)
uv run server.py

# æˆ–è€…ç›´æŽ¥ä½¿ç”¨ Python
python server.py
```

æœåŠ¡å¯åŠ¨åŽï¼Œè®¿é—® http://localhost:5000 å³å¯ä½¿ç”¨ã€‚

## ðŸ“– ä½¿ç”¨è¯´æ˜Ž

### Webç•Œé¢

- **é¦–é¡µ** (`/`): æŸ¥çœ‹ä»Šæ—¥æœ€æ–°å…¬æ–‡é€šçŸ¥
- **å½’æ¡£é¡µ** (`/archive`): æµè§ˆåŽ†å²å…¬æ–‡ï¼Œæ”¯æŒåˆ†é¡µ
- **è®¢é˜…ç®¡ç†** (`/subscribe`): ç®¡ç†é‚®ä»¶è®¢é˜…è®¾ç½®

### é‚®ä»¶è®¢é˜…åŠŸèƒ½

1. **è®¢é˜…è®¾ç½®**:
   - æ”¯æŒå…¨éƒ¨å¹³å°æˆ–é€‰æ‹©ç‰¹å®šå¹³å°è®¢é˜…
   - å¯è®¾ç½®1-24å°æ—¶çš„ä¸ªæ€§åŒ–æŽ¨é€é¢‘çŽ‡
   - å®žæ—¶æŽ¨é€æ–°å…¬æ–‡é€šçŸ¥

2. **é‚®ä»¶æ ¼å¼**:
   - ç²¾ç¾Žçš„HTMLé‚®ä»¶æ¨¡æ¿
   - æŒ‰å¹³å°åˆ†ç»„æ˜¾ç¤ºæ–°é€šçŸ¥
   - åŒ…å«æ ‡é¢˜ã€æ¥æºã€æ—¶é—´å’Œé“¾æŽ¥

### APIæŽ¥å£

```bash
# èŽ·å–æ–‡ç« æ•°æ®
GET /api/get_data?page=1&per_page=10

# èŽ·å–ä»Šæ—¥æ–‡ç« 
GET /api/get_today_data

# é‚®ä»¶è®¢é˜…
POST /api/subscribe

# å–æ¶ˆè®¢é˜…  
POST /api/unsubscribe

# èŽ·å–å¹³å°åˆ—è¡¨
GET /api/get_platforms

# èŽ·å–ç»Ÿè®¡æ•°æ®
GET /api/get_stats
```

## ðŸ”§ é¡¹ç›®ç»“æž„

```
GoldenMouse/
â”œâ”€â”€ server.py                    # FlaskæœåŠ¡å™¨ä¸»æ–‡ä»¶
â”œâ”€â”€ config.py                    # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ pyproject.toml               # uvé¡¹ç›®é…ç½®
â”œâ”€â”€ requirements.txt             # pipä¾èµ–åˆ—è¡¨
â”œâ”€â”€ LICENSE                      # MITè®¸å¯è¯
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜Žæ–‡æ¡£
â”œâ”€â”€ static/                      # é™æ€æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ today.html              # ä»Šæ—¥é€šçŸ¥é¡µé¢
â”‚   â”œâ”€â”€ index.html              # å½’æ¡£é¡µé¢
â”‚   â””â”€â”€ subscribe.html          # è®¢é˜…ç®¡ç†é¡µé¢
â”œâ”€â”€ database/                    # æ•°æ®åº“æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ articles.sqlite3        # æ–‡ç« æ•°æ®åº“
â”‚   â””â”€â”€ subscribers.sqlite3     # è®¢é˜…è€…æ•°æ®åº“
â”œâ”€â”€ official_document_crawler/   # çˆ¬è™«æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main_crawler.py         # ä¸»çˆ¬è™«ç¨‹åº
â”‚   â””â”€â”€ crawler/                # çˆ¬è™«æ ¸å¿ƒæ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ config.py           # çˆ¬è™«é…ç½®
â”‚       â”œâ”€â”€ database.py         # æ•°æ®åº“æ“ä½œ
â”‚       â”œâ”€â”€ fetcher.py          # æ•°æ®æŠ“å–
â”‚       â”œâ”€â”€ parser.py           # å†…å®¹è§£æž
â”‚       â”œâ”€â”€ stats.py            # ç»Ÿè®¡åŠŸèƒ½
â”‚       â””â”€â”€ utils.py            # å·¥å…·å‡½æ•°
â””â”€â”€ email_subscriber/            # é‚®ä»¶è®¢é˜…æ¨¡å—
    â”œâ”€â”€ subscriber_manager.py   # è®¢é˜…ç®¡ç†æœåŠ¡
    â”œâ”€â”€ subscriberDB.py         # è®¢é˜…æ•°æ®åº“
    â””â”€â”€ config.py               # é‚®ä»¶é…ç½®
```

## âš™ï¸ é…ç½®è¯´æ˜Ž

### æ•°æ®åº“é…ç½®

ç³»ç»Ÿä½¿ç”¨SQLiteæ•°æ®åº“ï¼Œé…ç½®åœ¨ `config.py` ä¸­ï¼š

```python
# æ–‡ç« æ•°æ®åº“
ARTICLES_DATABASE_URI = f"sqlite:///{str(DATABASE_DIR)}/articles.sqlite3"

# è®¢é˜…è€…æ•°æ®åº“  
SUBSCRIBERS_DATABASE_URI = f"sqlite:///{str(DATABASE_DIR)}/subscribers.sqlite3"
```

### çˆ¬è™«é…ç½®

å¯åœ¨ `config.py` ä¸­è°ƒæ•´çˆ¬è™«å‚æ•°ï¼š

```python
# è¯·æ±‚é‡è¯•æ¬¡æ•°
MAX_RETRIES = 4

# è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
REQUEST_TIMEOUT = 5

# ä¼‘çœ æ—¶é—´é…ç½®ï¼ˆç§’ï¼‰
SLEEP_INTERVAL = {
    "default": 0.5,
    "every_10": 1,
    "every_30": 2,
    "every_50": 2, 
    "every_200": 5,
}
```

### è®¢é˜…é™åˆ¶

é»˜è®¤åªå…è®¸æ·±åœ³æŠ€æœ¯å¤§å­¦å­¦ç”Ÿé‚®ç®±è®¢é˜…ï¼š

```python
# è®¢é˜…è€…é‚®ç®±æ ¼å¼é™åˆ¶
SUBSCRIBER_MASK = r"^\d+@stumail\.sztu\.edu\.cn$"
```

## ðŸ”„ å®šæ—¶ä»»åŠ¡

ç³»ç»Ÿå†…ç½®å®šæ—¶çˆ¬å–åŠŸèƒ½ï¼š

- **çˆ¬å–é¢‘çŽ‡**: æ¯30åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
- **æŽ¨é€é€»è¾‘**: å‘çŽ°æ–°æ–‡ç« æ—¶æŒ‰ç”¨æˆ·è®¾å®šé¢‘çŽ‡æŽ¨é€
- **åŽ»é‡æœºåˆ¶**: é¿å…é‡å¤æŽ¨é€ç›¸åŒæ–‡ç« 

## ðŸ‘¨â€ðŸ’» å¼€å‘è€…æŒ‡å—

å¦‚æžœæ‚¨æƒ³å°†æ­¤é¡¹ç›®é€‚é…åˆ°è‡ªå·±çš„å­¦æ ¡ï¼Œéœ€è¦è¿›è¡Œä»¥ä¸‹ä¿®æ”¹ï¼š

### 1. ä¿®æ”¹çˆ¬è™«é…ç½®

ç¼–è¾‘ `config.py` ä¸­çš„çˆ¬è™«ç›¸å…³é…ç½®ï¼š

```python
# ========== çˆ¬è™«é…ç½® ==========
# åŸºç¡€URL - æ›¿æ¢ä¸ºæ‚¨å­¦æ ¡çš„å…¬æ–‡é€šç½‘å€
BASE_URL = "https://your-school-website.edu.cn"

# åˆ—è¡¨é¡µURLæ¨¡æ¿ - æ ¹æ®æ‚¨å­¦æ ¡çš„URLæ ¼å¼è°ƒæ•´
LIST_URL_TEMPLATE = f"{BASE_URL}/list.jsp?totalpage=XXX&PAGENUM={{page}}&urltype=tree.TreeTempUrl&wbtreeid=XXXX"

# è¯¦æƒ…é¡µURLå‰ç¼€
INFO_URL_PREFIX = f"{BASE_URL}/info/"

# è¯·æ±‚å¤´ - å¯èƒ½éœ€è¦æ ¹æ®ç›®æ ‡ç½‘ç«™è°ƒæ•´
HEADERS = {
    "Referer": "https://your-school-website.edu.cn/",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36",
}
```

### 2. ä¿®æ”¹æ•°æ®è§£æžé€»è¾‘

æ ¹æ®æ‚¨å­¦æ ¡ç½‘ç«™çš„HTMLç»“æž„ï¼Œä¿®æ”¹ä»¥ä¸‹æ–‡ä»¶ï¼š

**a) `official_document_crawler/crawler/fetcher.py`**

è°ƒæ•´æ–‡ç« åˆ—è¡¨è§£æžçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š

```python
# æ ¹æ®æ‚¨å­¦æ ¡ç½‘ç«™çš„HTMLç»“æž„è°ƒæ•´è¿™äº›æ­£åˆ™è¡¨è¾¾å¼
types = re.findall(r'target="_self">(.*?)</a></div>', html_content)
units = re.findall(r'style="font-size: 14px;">(.*?)</a></div>', html_content)
dates = re.findall(r'style="width:11%;">(.*?)</div>', html_content)
titles = re.findall(r'.htm" title="(.*?)"  target="_blank" style="', html_content)
urls = re.findall(r'"><a href="info/(.*?)" title="', html_content)
```

**b) `official_document_crawler/crawler/parser.py`**

è°ƒæ•´æ–‡ç« è¯¦æƒ…è§£æžé€»è¾‘ï¼š

```python
# æ ¹æ®æ‚¨å­¦æ ¡ç½‘ç«™çš„HTMLç»“æž„è°ƒæ•´è§£æžé€»è¾‘
def parse_article_details(html_content):
    # è°ƒæ•´å†…å®¹æå–çš„CSSé€‰æ‹©å™¨
    content_form = soup.select('form[name="_newscontent_fromname"]')  # æ ¹æ®å®žé™…ç»“æž„ä¿®æ”¹
    
    # è°ƒæ•´æ—¶é—´æå–é€»è¾‘
    time_span = soup.select_one('span:-soup-contains("å‘å¸ƒæ—¶é—´")')  # æ ¹æ®å®žé™…ç»“æž„ä¿®æ”¹
    
    # è°ƒæ•´å…¶ä»–å­—æ®µçš„æå–é€»è¾‘...
```

### 3. ä¿®æ”¹é‚®ç®±éªŒè¯è§„åˆ™

åœ¨ `config.py` ä¸­ä¿®æ”¹é‚®ç®±æ ¼å¼é™åˆ¶ï¼š

```python
# ä¿®æ”¹ä¸ºæ‚¨å­¦æ ¡çš„é‚®ç®±æ ¼å¼
SUBSCRIBER_MASK = r"^[a-zA-Z0-9._%+-]+@your-school\.edu\.cn$"
```

### 4. æµ‹è¯•å’Œè°ƒè¯•

1. **å°èŒƒå›´æµ‹è¯•**: å…ˆç”¨å°é¡µç èŒƒå›´æµ‹è¯•çˆ¬è™«æ˜¯å¦æ­£å¸¸å·¥ä½œ
2. **æ£€æŸ¥æ•°æ®**: ç¡®è®¤æŠ“å–çš„æ•°æ®æ ¼å¼æ­£ç¡®
3. **é‚®ä»¶æµ‹è¯•**: ä½¿ç”¨æµ‹è¯•é‚®ç®±éªŒè¯é‚®ä»¶å‘é€åŠŸèƒ½

### 5. é‡è¦æç¤º âš ï¸

**åˆè§„æ€§è­¦å‘Š**ï¼šåœ¨ä½¿ç”¨æ­¤ç³»ç»Ÿå‰ï¼Œè¯·åŠ¡å¿…ï¼š

1. **ç¡®è®¤åˆè§„æ€§**: æ£€æŸ¥æ‚¨å­¦æ ¡çš„å…¬æ–‡é€šçŸ¥æ˜¯å¦å…è®¸å¯¹å¤–ä¼ æ’­
2. **èŽ·å¾—æŽˆæƒ**: å¦‚æœ‰å¿…è¦ï¼Œè¯·èŽ·å¾—å­¦æ ¡ç›¸å…³éƒ¨é—¨çš„ä½¿ç”¨æŽˆæƒ
3. **éµå®ˆåè®®**: ç¡®ä¿éµå®ˆå­¦æ ¡ç½‘ç«™çš„ä½¿ç”¨æ¡æ¬¾å’Œrobots.txtè§„å®š
4. **æŽ§åˆ¶è®¿é—®é¢‘çŽ‡**: é¿å…å¯¹ç›®æ ‡ç½‘ç«™é€ æˆè¿‡å¤§è´Ÿè½½
5. **ä¿æŠ¤éšç§**: ç¡®ä¿ä¸ä¼ æ’­åŒ…å«ä¸ªäººéšç§ä¿¡æ¯çš„å†…å®¹

**å»ºè®®**ï¼š
- åœ¨æ­£å¼ä½¿ç”¨å‰è”ç³»å­¦æ ¡ç½‘ç»œä¸­å¿ƒæˆ–ç›¸å…³æŠ€æœ¯éƒ¨é—¨
- è€ƒè™‘ä¸Žå­¦æ ¡åˆä½œï¼ŒèŽ·å¾—å®˜æ–¹APIæ”¯æŒ
- è®¾ç½®åˆç†çš„çˆ¬å–é—´éš”ï¼Œé¿å…å½±å“æ­£å¸¸æœåŠ¡

## ðŸ› æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **é‚®ä»¶å‘é€å¤±è´¥**
   - æ£€æŸ¥SMTPé…ç½®æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤é‚®ç®±æœåŠ¡å•†SMTPæœåŠ¡å·²å¼€å¯
   - éªŒè¯æŽˆæƒç /åº”ç”¨å¯†ç æ˜¯å¦æ­£ç¡®

2. **æ•°æ®åº“è¿žæŽ¥é”™è¯¯**
   - ç¡®ä¿databaseç›®å½•å­˜åœ¨ä¸”æœ‰å†™å…¥æƒé™
   - æ£€æŸ¥SQLiteæ–‡ä»¶æ˜¯å¦æŸå

3. **çˆ¬è™«æ— æ³•èŽ·å–æ•°æ®**
   - æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
   - ç¡®è®¤ç›®æ ‡ç½‘ç«™æ˜¯å¦å¯è®¿é—®
   - æŸ¥çœ‹æ˜¯å¦éœ€è¦æ›´æ–°è¯·æ±‚å¤´
   - æ£€æŸ¥ç½‘ç«™ç»“æž„æ˜¯å¦å‘ç”Ÿå˜åŒ–

### æ—¥å¿—è°ƒè¯•

æœåŠ¡è¿è¡Œæ—¶ä¼šåœ¨æŽ§åˆ¶å°è¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼ŒåŒ…æ‹¬ï¼š
- ðŸš€ æœåŠ¡å¯åŠ¨ä¿¡æ¯
- ðŸ“Š æ•°æ®åº“æŸ¥è¯¢ç»“æžœ  
- ðŸ“§ é‚®ä»¶å‘é€çŠ¶æ€
- â° å®šæ—¶ä»»åŠ¡æ‰§è¡Œæƒ…å†µ

## ðŸ¤ è´¡çŒ®

æ¬¢è¿Žæäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›é¡¹ç›®ï¼

### è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æŽ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ðŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäºŽ [MIT License](LICENSE) å¼€æºã€‚

## ðŸ‘¥ ä½œè€…

GoldenMouse Team - è®©æ ¡å›­ä¿¡æ¯è§¦æ‰‹å¯åŠ ðŸ­

---

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è®¿é—®é¡¹ç›®ä¸»é¡µæˆ–æäº¤Issueã€‚
